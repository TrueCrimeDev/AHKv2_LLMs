<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AHKv2 &amp; LLMs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
  <script src="repos-feed.js" defer></script>
</head>
<body>
  <main class="main-grid">
    <header class="site-header">
      <a href="index.html" class="logo">
        <span class="logo-mark">AHK</span>
        <span class="logo-text">v2 &amp; LLMs</span>
      </a>
      <nav class="nav">
        <a href="#posts" class="nav-link">Posts</a>
        <a href="#repos" class="nav-link">Repos</a>
        <a href="https://www.autohotkey.com/docs/v2/" target="_blank" class="nav-link">AHK Docs</a>
      </nav>
    </header>
    <div class="content-col">
      <section class="hero-section">
        <h1>AutoHotkey v2 &amp; LLM Development</h1>
        <p>Deep dives into object-oriented programming, GUI design, prompt engineering, and modern scripting techniques for pairing AHK v2 with coding agents.</p>
      </section>

      <section class="posts-section" id="posts">
        <div class="section-header">
          <h2>Articles</h2>
        </div>
        <div id="post-grid" class="post-grid">
          <div class="post-card skeleton">
            <div class="skeleton-bar short"></div>
            <div class="skeleton-bar"></div>
            <div class="skeleton-bar wide"></div>
          </div>
        </div>
      </section>
    </div>

    <aside class="sidebar-col" id="repos">
      <div class="sidebar-header">
        <h3>AHK v2 Repos</h3>
        <span class="sidebar-subtitle">Latest from GitHub</span>
      </div>
      <div id="repos-feed-container" class="repos-container"></div>
    </aside>

    <footer class="site-footer">
      <span>&copy; 2025 AHKv2 &amp; LLMs</span>
      <div class="footer-links">
        <a href="https://github.com/AutoHotkey" target="_blank">GitHub</a>
        <a href="https://www.autohotkey.com/boards/" target="_blank">Forums</a>
      </div>
    </footer>
  </main>

  <script>
    async function loadPosts() {
      const grid = document.getElementById('post-grid');
      try {
        const response = await fetch('posts/posts.json');
        if (!response.ok) throw new Error('Unable to load posts.');
        const posts = await response.json();
        if (!posts.length) {
          grid.innerHTML = '<p class="empty-state">No posts yet.</p>';
          return;
        }

        const cards = posts
          .sort((a, b) => new Date(b.date) - new Date(a.date))
          .map(post => {
            const date = new Date(post.date).toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' });
            const tags = (post.tags || [])
              .map(tag => `<span class="tag">${tag}</span>`)
              .join('');
            const href = `post.html?slug=${encodeURIComponent(post.slug)}`;
            return `
              <article class="post-card">
                <a class="post-link" href="${href}">
                  <div class="post-meta">
                    <time datetime="${post.date}">${date}</time>
                  </div>
                  <h3 class="post-title">${post.title}</h3>
                  <p class="post-excerpt">${post.description}</p>
                  <div class="tag-row">${tags}</div>
                </a>
              </article>
            `;
          })
          .join('');

        grid.innerHTML = cards;
      } catch (error) {
        console.error(error);
        grid.innerHTML = '<p class="empty-state">Failed to load posts.</p>';
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      const feed = new ReposFeed('repos-feed-container', { limit: 25 });
      feed.fetchRepos();
      loadPosts();
    });
  </script>
</body>
</html>
